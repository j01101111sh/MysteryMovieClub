{% if user.is_authenticated and user != review.user %}
    <!-- Voting buttons for authenticated users (not the review author) -->
    <div class="d-flex gap-2 align-items-center mt-2">
        <small class="text-muted me-2">Was this review helpful?</small>
        <form method="post"
              action="{% url 'movies:review_helpful_vote' review.pk %}?next={{ request.path }}"
              class="d-inline review-helpful-form"
              data-review-id="{{ review.pk }}">
            {% csrf_token %}
            <input type="hidden" name="is_helpful" value="true" />
            <button type="submit"
                    class="btn btn-sm {% if user_voted_helpful.review.pk == review.pk and user_voted_helpful.is_helpful %}btn-success{% else %}btn-outline-success{% endif %}"
                    title="Mark as helpful">
                ğŸ‘ <span class="helpful-count">{{ review.helpful_count }}</span>
            </button>
        </form>
        <form method="post"
              action="{% url 'movies:review_helpful_vote' review.pk %}?next={{ request.path }}"
              class="d-inline review-helpful-form"
              data-review-id="{{ review.pk }}">
            {% csrf_token %}
            <input type="hidden" name="is_helpful" value="false" />
            <button type="submit"
                    class="btn btn-sm {% if user_voted_helpful.review.pk == review.pk and not user_voted_helpful.is_helpful %}btn-danger{% else %}btn-outline-danger{% endif %}"
                    title="Mark as not helpful">
                ğŸ‘ <span class="not-helpful-count">{{ review.not_helpful_count }}</span>
            </button>
        </form>
    </div>
{% else %}
    <!-- Display-only for anonymous users and review authors -->
    <div class="mt-2">
        <small class="text-muted">
            Helpfulness:
            <span class="badge bg-success">ğŸ‘ {{ review.helpful_count }}</span>
            <span class="badge bg-danger">ğŸ‘ {{ review.not_helpful_count }}</span>
            {% if review.helpful_count > 0 or review.not_helpful_count > 0 %}
                <span class="badge bg-secondary">{{ review.helpfulness_score|floatformat:0 }}% found helpful</span>
            {% endif %}
        </small>
    </div>
{% endif %}
